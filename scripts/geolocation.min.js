/**!
 * Created by ZweiL on 2016/12/5.
 *
 * 异步加载百度定位api，并获取地理位置信息；
 * loadScript(ak,callback) 入口函数，ak为百度的密钥；callback为成功后的处理函数，返回结果值参考控制台输出，
 * 成功后会自动调用getLocation(callback)，并把callback传递给它；
 *
 * getLocation(callback) 启用浏览器获取经纬度的api；
 * callback(result) 回调函数，返回的数据将作为第一个参数传入。
 */
function getLocation(callback){function onSuccess(position){var longitude=position.coords.longitude,latitude=position.coords.latitude,myGeo=new BMap.Geocoder;myGeo.getLocation(new BMap.Point(longitude,latitude),function(result){result&&(console.log(result),callback(result))})}function onError(error){switch(error.code){case 1:console.log("位置服务被拒绝");break;case 2:console.log("暂时获取不到位置信息");break;case 3:console.log("获取信息超时");break;case 4:console.log("未知错误")}}var options={"enableHighAccuracy":!0,"maximumAge":1e3};navigator.geolocation.getCurrentPosition(onSuccess,onError,options)}function loadScript(ak,callback){if(!ak)return void console.log("未传入百度密钥");if(!callback)return void console.log("未传入回调函数");if(navigator.geolocation){console.log("浏览器支持geolocation");var script=document.createElement("script");script.src="http://api.map.baidu.com/api?v=2.0&ak="+ak+"&callback=getLocation("+callback+")",document.body.appendChild(script)}else console.log("浏览器不支持geolocation")}